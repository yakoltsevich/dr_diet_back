import { Injectable } from '@nestjs/common';

@Injectable()
export class PromptBuilder {
  build(profile: any, dayNumber: number): string {
    const days = [
      '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫',
      '–í—Ç–æ—Ä–Ω–∏–∫',
      '–°—Ä–µ–¥–∞',
      '–ß–µ—Ç–≤–µ—Ä–≥',
      '–ü—è—Ç–Ω–∏—Ü–∞',
      '–°—É–±–±–æ—Ç–∞',
      '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ',
    ];
    const dayName = days[dayNumber - 1] || `–î–µ–Ω—å ${dayNumber}`;

    return `
–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–µ—Ç–æ–ª–æ–≥. –°–æ—Å—Ç–∞–≤—å —Ä–∞—Ü–∏–æ–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –¥–µ–Ω—å: ${dayName}.
–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä–æ–≥–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON, –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π, —Ç–µ–∫—Å—Ç–∞ –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ.

üî∏ –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:

{
  "day": ${dayNumber},
  "breakfast": {
    "dish": "–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞",
    "recipe": {
      "ingredients": [
        { "item": "–ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞", "amount": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å –µ–¥–∏–Ω–∏—Ü–µ–π –∏–∑–º–µ—Ä–µ–Ω–∏—è" }
      ],
      "steps": [
        "–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è 1",
        "–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è 2"
      ]
    },
    "total": {
      "calories": —á–∏—Å–ª–æ,
      "protein": —á–∏—Å–ª–æ,
      "fat": —á–∏—Å–ª–æ,
      "carbs": —á–∏—Å–ª–æ
    }
  },
  "lunch": { ... },
  "dinner": { ... },
  "total": {
    "calories": —Å—É–º–º–∞ –∑–∞ –¥–µ–Ω—å,
    "protein": —Å—É–º–º–∞ –∑–∞ –¥–µ–Ω—å,
    "fat": —Å—É–º–º–∞ –∑–∞ –¥–µ–Ω—å,
    "carbs": —Å—É–º–º–∞ –∑–∞ –¥–µ–Ω—å
  }
}

üîπ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –¢–æ–ª—å–∫–æ JSON-–æ–±—ä–µ–∫—Ç, –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞.
- –ü–æ–ª–µ ingredients –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ —Å –∫–ª—é—á–∞–º–∏ item –∏ amount.
- –ü–æ–ª–µ steps ‚Äî –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫.
- –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ total ‚Äî —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞.
- –£—á–∏—Ç—ã–≤–∞–π, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Å–æ–±–ª—é–¥–∞–π —Ç–æ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –ü–æ–ª: ${profile.gender}
- –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${profile.birthDate}
- –†–æ—Å—Ç: ${profile.height} —Å–º
- –í–µ—Å: ${profile.weight} –∫–≥
- –¶–µ–ª—å: ${profile.goal}
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${profile.activityLevel}
- –ê–ª–ª–µ—Ä–≥–∏–∏: ${profile.allergies?.join(', ') || '–Ω–µ—Ç'}
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è: ${profile.dietaryPreferences?.join(', ') || '–Ω–µ—Ç'}
- –õ—é–±–∏–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã: ${profile.favoriteFoods?.join(', ') || '–Ω–µ—Ç'}
- –ù–µ–ª—é–±–∏–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã: ${profile.dislikedFoods?.join(', ') || '–Ω–µ—Ç'}
    `.trim();
  }
}
